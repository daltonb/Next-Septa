(function(a){a.Manager=function(e){var c={},b=$.extend({id:"container",components:{}},e),d={};var g;function f(){g=$("#isepta-dialog");$(".nxs-dialog-open").click(function(){g.css("top",window.scrollY+8);g.show();return false});$(".close",g).click(function(){g.hide()})}c.getPath=function(j){var i="";var h=["routeType","routeId","direction","from","to"];$.each(h,function(l,k){if(d[k]){i+="/"+d[k];return true}return false});if(j){i+="/"+j}return i};c.init=function(){var h=$("#content");d={routeType:h.attr("data-type"),routeId:h.attr("data-route"),direction:h.attr("data-direction"),from:h.attr("data-from"),to:h.attr("data-to")};$.each(b.components,function(i,j){j.init(c,d)});f();return c};return c}})(NextSepta);(function(a){a.Stops=function(l){var i={},j={id:"stops",target:"#content"},d,c,b=[];var h=[{l:"week",s:604800},{l:"day",s:86400},{l:"hr",s:3600},{l:"min",s:60}];function k(o){if(o<0){return"(GONE)"}else{if(o<60){return"(< 1 min)"}else{var n="",m=0;$.each(h,function(q,p){if(o>p.s){m=Math.floor(o/p.s);if(n){n+=" "}n+=m+" "+p.l+(m==1?"":"s");o=o%p.s}});return"("+n+")"}}}function e(){var m=new Date();$.each(b,function(o,n){var p=(n.time-m)/1000;n.el.html(k(p))});if(b.length){setTimeout(function(){e()},25000)}}function f(m){$(".nxs-stoptime").each(function(){var o=$(this).attr("data-block"),q=$(this).attr("data-trip");if(o&&o in m){var n=m[o];var p=d.getPath("map?bus="+n.VehicleID+"&trip="+q);$(".nxs-stoptime-aside",this).html('<a href="'+p+'">map</a>')}})}function g(m){a.Data.get("/locations/"+m,function(o){var n={};if(o.bus){$.each(o.bus,function(q,p){n[p.BlockID]=p})}f(n)})}i.init=function(m,n){d=m;c=n;$(".nxs-stoptime-left").each(function(){var p=$("time",this).attr("datetime"),q=$("span",this);if(p){var o=new Date(Date.parse(p));if(o&&!$.isNaN(o)){b.push({time:o,el:q})}}});if(c.routeType==="buses"&&c.routeId){g(c.routeId)}e();return i};return i}})(NextSepta);